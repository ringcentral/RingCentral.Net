<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RingCentral .Net SDK: WebSocket Extension</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RingCentral .Net SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">WebSocket Extension </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>WebSocket Extension adds support for WebSocket protocol.</p>
<div class="fragment"><div class="line">var rc = <span class="keyword">new</span> RestClient(...);</div>
<div class="line">var webSocketExtension = <span class="keyword">new</span> WebSocketExtension(...);</div>
<div class="line">await rc.InstallExtension(webSocketExtension);</div>
<div class="line"> </div>
<div class="line">var eventFilters = <span class="keyword">new</span>[]</div>
<div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;/restapi/v1.0/account/~/extension/~/message-store&quot;</span></div>
<div class="line">};</div>
<div class="line">var subscription = await webSocketExtension.Subscribe(eventFilters, message =&gt;</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// do something with message</span></div>
<div class="line">});</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1"></a>
Limitations</h1>
<p>Each WebSocketExtension can only create one subscription. If you need to create multiple subscriptions, you need to create multiple WebSocketExtension instances. Creating multiple subscriptions with one WebSocketExtension instance will cause the last subscription to override the previous ones.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
24 * 7 long running applications</h1>
<p>In order to keep your WebSocket appliation 24 * 7 running, there are several things that you need to handle:</p>
<ul>
<li>first of all, you need to keep you token valid. You can use <code>rc.Refresh()</code> to refresh the token.</li>
<li>secondly, you need to handle network outage. If there is a network outage, you need to <code>wsExtension.Reconnect()</code> when network is back.</li>
<li>lastly, there is a rare case: There is a 5 active oauth sessions per user per app limit. If you try to create 5 + sessions, existing ones will be revoked and <code>rc.Refresh()</code> will fail and your WebSocket connection will not function either. In this case, you need to generate a new token and <code>wsExtension.Reconnect()</code>.</li>
</ul>
<p>Please refer to this demo code: <a href="https://github.com/tylerlong/RingCentral.WebSocket.Demo/blob/main/RingCentral.WebSocket.Demo/Program.cs">https://github.com/tylerlong/RingCentral.WebSocket.Demo/blob/main/RingCentral.WebSocket.Demo/Program.cs</a></p>
<p>Please read the <b>comments</b> in the code carefully. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
